\documentclass{article}
\usepackage{fullpage}

\usepackage[ngerman, english]{babel}
\renewcommand{\familydefault}{\sfdefault}
\usepackage[scaled=1]{helvet}
\usepackage[helvet]{sfmath}
\everymath={\sf}

\usepackage{parskip}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{siunitx}
\DeclareSIUnit\molar{M}

\title{Manual for the LabView Integration UI}
\author{Johann Brenner}
%\company{The University of Western Ontario}
\setcounter{tocdepth}{3}

\newcounter{ListCounter}


\begin{document}
	\maketitle
	\tableofcontents 



\section{User Guide}

\subsection{Prequisites}
\begin{itemize}
	\item	The program is not very fast. In case something does not happen instantly, be patient and try to avoid clicking multiple times. This mostly results in unpredictable behavior.
	\item	If the software is not already installed on the computer, refer to the README.md file.
	
\end{itemize}


\subsection{Starting the software}
\label{sec:software_start}
\begin{enumerate}
	\item Ensure that the following devices are booted and connected to the PC
	\begin{itemize}
		\item Olympus Microscope
		\item TANGO Stage Controller
		\item SOLA Light Engine
		\item Valve Controller 
	\end{itemize}
	\item Start the LabvView project UI\_{}Project.lvproj
	\item Expand the VIs subfolder and start the latest version of the UI
	\item Click the Run or Run-Continously button on the top left corner
	\item Normally, the COM ports can stay unmodified. However, (mainly after Windows Updates) these ports tend to change. Their correctness can be verified in the Device-Manager (GerÃ¤te-Manager) by plugging them out and back in.
	\item The red lamps on the top-left corner turn green upon successful connection to the respective device.
	\subitem If a lamp stays red:
	\begin{itemize}
		\item Hit the STOP-Button and start over
		\item If the lamp is still red, switch the respective device off and on again.
		\item Ensure the correct COM-Port is selected. (Via Device-Manager or NI-Device Monitor)
	\end{itemize}

	\item Wait until the status field says ``Initialization finished successfully''
	\item 	Now, the program is fully operational.
\end{enumerate}



\subsection{Operating a Multiring chip}
Make sure you started the program according to section \ref{sec:software_start}.
	\subsubsection{Initalization}
	\begin{enumerate}
	\item Start the Elveflow device and the \textbf{ESI} software, close all valves
	\item Pressurize the Elveflow with \SIrange{4}{8}{\bar}.
	\item Wipe the microfluidic with Acetone, IPA and ddH20 to remove dust etc., which cause imaging artifacts
	\item 	Fill the control tubing with ddH2O with a \SI{1}{\milli\liter} syringe and connect it to the respective inlet
	\item 	Insert the chip carefully into the microscope
	\item 	Ensure that the tubing does not interfere with the other devices and can move freely during stage driving
	\item Connect a \SI{40}{\micro\molar} Fluorescein solution to the Elveflow
	\begin{itemize}
		\item Apply \SIrange{10}{20}{\milli\bar} at the respective \textbf{ESI} channel to move the fluid to the end of the tubing until a drop starts to form
		\item  Insert the connector to Inlet 1 of the chip
	\end{itemize}

	\item Connect ddH$_{2}$O or nfH$_{2}$O to the Elveflow		\begin{itemize}
		\item Apply \SIrange{10}{20}{\milli\bar} at the respective \textbf{ESI} channel to move the fluid to the end of the tubing until a drop starts to form
		\item  Insert the connector to Inlet 2 of the chip
	\end{itemize}
	\item Build a connector from small-diameter PTFE-tubing to big-diameter PTFE-tubing; connect it to a waste container and the outlet of the chip (To minimize the hydraulic resistance and capacitive air effects)
	\item Start the Labview program
	\item Click the \textbf{Live} Button, adjust \textbf{Filter}, \textbf{Intensity} and \textbf{Exposure} settings.
	\item Pressurize the control valves with \SI{1.5}{\bar}
	\item Click the \textbf{No Flow} Button to pressurize all quake valves
	\setcounter{ListCounter}{\value{enumi}}
		\end{enumerate}
	
	\subsubsection{Loading the chip}
		\begin{enumerate}
			\setcounter{enumi}{\value{ListCounter}}
	\item Check the control inlets for leaks and wait for the channels to fill
	\item Pressurize the \textbf{ESI} channels for water and fluorescein to \SI{250}{\milli\bar}
	\item Select \textit{Reagent 2} and click the \textbf{Flush} Button to inject the fluorescein
		\setcounter{ListCounter}{\value{enumi}}
	\end{enumerate}
		
	\subsubsection{Adjusting the valve pressure}
	\begin{enumerate}                 
	\setcounter{enumi}{\value{ListCounter}}
	\item Upon arrival, deactivate \textbf{Flush} and switch to the \textit{GFP} filter; adjust \textit{exposure} (exit live mode) and \textit{intensity} as well as the histogram sliders
	\item Use the \textit{10x Objective} and move to a valve in the reagent-multiplexer.
	\subitem Increase the pressure until you see two meniski, which indicates that the valve closes completely.
	\item Repeat the same procedure for the ring pump	\setcounter{ListCounter}{\value{enumi}}
\end{enumerate}


	
	\subsubsection{Remove air}
			\begin{enumerate}
		\setcounter{enumi}{\value{ListCounter}}
	\item select \textit{Reagent 1} and click the \textbf{Flush} Button again to inject the water
	\subitem For faster flushing, the \textbf{ESI} pressure can be increased up to \SI{500}{\milli \bar}  
	\subitem Upon arrival, let it flush as long as air is in the flushing channel between the rings
	\item Deactivate the \textbf{Flush}, click \textbf{All Valves} and load all rings with \textbf{Load}
	\subitem Wait until all rings are partly filled
	\subitem Activate manually the valve \textit{A5} to load another side of the ring
	\subitem Deactivate \textit{A5} and open \textit{B5} to close the outlet.
	\subitem This will pressurize all channel and remove remaining air bubbles.
		\setcounter{ListCounter}{\value{enumi}}
\end{enumerate}


	
	\subsubsection{Performing the pump calibration}
	\begin{enumerate}
		\setcounter{enumi}{\value{ListCounter}}
	\item Click the \textbf{No Flow} Button
	\item Ensure the \textit{Position List} is empty
	\subitem if not, hit the \textbf{Clear Last} button
	\item Move to every ring, starting at the bottom (of live mode) and capture one position of each ring with \textbf{Save Pos} 
	\item Exit \textit{Live Mode} and hit \textbf{Capture Blank} of the calibration panel at the bottom; follow the instructions and wait until the acquisition is finished
	\item Change to \textit{GFP}, go into \textbf{Live} and \textbf{Flush} with Fluorescein for \SI{10}{\second}
	\item Make sure \textbf{All Valves} is still on and load all rings with \textbf{Load}
	\item Exit \textbf{Live} and \textbf{Capture Full Intensity}
	\item Go into \textbf{Live}, make sure \textbf{All Valves} is still on and \textbf{Load} all rings with Fluorescein
	\item Exit \textbf{Load} and adjust \textit{Feed} and \textit{Pump} cycles
	\subitem Best results were achieved with $>$800 \textit{Pump Cycles} and $\sim$30 \textit{Feed Cycles}
	\item Hit \textbf{Capture Dilutions}
	\subitem After the first dilution cycle, the (a bit under-)estimated remaining time is displayed 
	\subitem At finish, an input dialog with 8 refresh ratios is displayed
	\item Start MATLAB and run the \textit{CalibrationScript.m} under \textit{lib $\rightarrow$ Calib}
	\subitem Write the according \textbf{Refresh Ratios per Pump Cycle} back into Labview
	\subitem This is not ideal, I know...	\setcounter{ListCounter}{\value{enumi}}
\end{enumerate}


	\subsubsection{Creating a program}
	\begin{enumerate}
		\setcounter{enumi}{\value{ListCounter}}
	\item Clear the \textit{Position List} and capture your desired positions.
	\subitem \textbf{NOTE:} As the focus is always saved with the position, it makes a difference if the positions are captured in \textit{4x} or \textit{10x} or another magnification
	\item Save your position list with \textbf{Save List} with the suffix \textit{.xml} in a desired location
	\item Clear the \textit{Microscope Settings} by clicking the \textbf{Clear Last} Button
	\item Choose your desired acquisition settings (\textit{Filter}, \textit{Exposure}, \textit{Intensity}) and \textbf{Save Settings}
	\subitem Repeat it for every color you want to acquire
	\item \textbf{Save List} with the suffix \textit{.xml} at the same location as the positions
	\item Make sure that the Refresh Ratios are set correctly
	\item Start the \textbf{Program Setup}
	\item If you wish to modify a previously created program, click on \textbf{Load Old Program}
	\item Select the previouly created \textit{Microscope} and \textit{Position Settings} by clicking the \textbf{Folder Symbol}
	\subitem If the lists have been loaded correctly, the LED beneath the Folder turns green
	\item Now you can modify the program by clicking the respective buttons:
	\subitem \textbf{Feed}: Exchanges a defined fraction of a single ring
	\subitem \textbf{Pump}: Mixes all rings by actuating the ring pump. $\left(\textsf{Formula:\ Time}=\frac{\textsf{Pump\ Cycles}}{\SI{4}{\hertz}}\right)$
	\subitem \textbf{Change Reagent}: Flushes the outer channels with the selected reagent for a defined time
	\subitem \textbf{Loop Start}: Begins a unique Loop with a defined number of iterations 
	\subitem \textbf{Loop End}: Closes a unique Loop with its specified ID
	\item Hit \textbf{Save} and follow the instructions
	\subitem The later filename is composed of \textbf{YYMMDD\_{}hh\_{}mm\_{}ss\_{}''YOURPREFIX''.tif}
	\subitem For simple modifications you can also modify the \textit{.xml} file accordingly.
	
		\setcounter{ListCounter}{\value{enumi}}
\end{enumerate}



\end{document}
